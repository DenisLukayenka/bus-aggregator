version: '3.7'

services:
  webapigw:
    image: ${REGISTRY:-bus}/webapigw:${PLATFORM:-linux}-${TAG:-latest}
    build:
      context: .
      dockerfile: ApiGateway/Web.Bus.HttpAggregator/Dockerfile

  webstatus:
    image: ${REGISTRY:-bus}/webstatus:${PLATFORM:-linux}-${TAG:-latest}
    build:
      context: .
      dockerfile: WebStatus/Dockerfile

  webspa:
    image: ${REGISTRY:-bus}/webspa:${PLATFORM:-linux}-${TAG:-latest}
    build:
      context: .
      dockerfile: Web/Dockerfile
    depends_on:
      - data-api
      - adapter-api

  data-api:
    image: ${REGISTRY:-bus}/data.api:${PLATFORM:-linux}-${TAG:-latest}
    build:
      context: .
      dockerfile: Services/Data/Data.API/Dockerfile

  adapter-api:
    image: ${REGISTRY:-bus}/adapter.api:${PLATFORM:-linux}-${TAG:-latest}
    build:
      context: .
      dockerfile: Services/Adapter/Adapter.API/Dockerfile
